(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function o(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=o(n);fetch(n.href,i)}})();const ge="arcities.settings.v2";function Me(){try{const e=localStorage.getItem(ge);if(e)return JSON.parse(e)}catch{}return{maxDistanceKm:1e3,units:"km",hfovDeg:60,headingOffsetDeg:0,smoothing:.15,showOffscreenIndicators:!1}}function be(e){try{localStorage.setItem(ge,JSON.stringify(e))}catch{}}function Se(e){const t=e.settings||Me();e.settings=t;const o=document.getElementById("startBtn"),a=document.getElementById("helpBtn"),n=document.getElementById("onboarding"),i=document.getElementById("collapseBtn"),s=document.getElementById("controlsBody"),c=document.getElementById("distance"),r=document.getElementById("distanceValue"),m=document.getElementById("unitsKm"),p=document.getElementById("unitsMi"),v=document.getElementById("hfov"),B=document.getElementById("hfovValue"),D=document.getElementById("headingOffset"),F=document.getElementById("headingOffsetValue"),b=document.getElementById("smooth"),_=document.getElementById("smoothValue"),E=document.getElementById("showOffscreen"),C=document.getElementById("dbgHeading"),f=document.getElementById("dbgPitch"),L=document.getElementById("dbgRoll"),S=document.getElementById("dbgSource"),T=document.getElementById("dbgRate"),A=document.getElementById("dbgSmooth"),$=document.getElementById("geoText"),h=document.getElementById("manualGeo"),l=document.getElementById("lat"),d=document.getElementById("lon"),w=document.getElementById("setGeo");localStorage.getItem("arcities.onboarded")||n.showModal(),document.getElementById("onboardingClose").addEventListener("click",()=>{localStorage.setItem("arcities.onboarded","1")}),a.addEventListener("click",()=>n.showModal()),i.addEventListener("click",()=>{const u=!(i.getAttribute("aria-expanded")==="true");i.setAttribute("aria-expanded",String(u)),s.style.display=u?"block":"none",i.textContent=u?"▾":"▸"}),c.value=String(t.maxDistanceKm),v.value=String(t.hfovDeg),D.value=String(t.headingOffsetDeg),b.value=String(t.smoothing),t.units==="km"?m.checked=!0:p.checked=!0,E.checked=!!t.showOffscreenIndicators;function I(g,u){if(u==="km")return`${Math.round(g)} km`;const P=g*.621371;return`${Math.round(P)} mi`}function y(){r.textContent=I(Number(c.value),t.units),B.textContent=`${v.value}°`,F.textContent=`${D.value}°`,_.textContent=`${Number(b.value).toFixed(2)}`}y();function M(){be(t),e.onSettingsChange?.(t),y()}return c.addEventListener("input",()=>{t.maxDistanceKm=Number(c.value),M()}),v.addEventListener("input",()=>{t.hfovDeg=Number(v.value),M()}),D.addEventListener("input",()=>{t.headingOffsetDeg=Number(D.value),M()}),b.addEventListener("input",()=>{t.smoothing=Number(b.value),M()}),E.addEventListener("change",()=>{t.showOffscreenIndicators=E.checked,M()}),m.addEventListener("change",()=>{t.units="km",M()}),p.addEventListener("change",()=>{t.units="mi",M()}),o.addEventListener("click",()=>e.onStart?.()),w.addEventListener("click",()=>{const g=Number(l.value),u=Number(d.value);!Number.isFinite(g)||!Number.isFinite(u)||e.onManualGeo?.({lat:g,lon:u})}),{setGeoStatus(g){$.textContent=g},showManualGeo(g){h.classList.toggle("hidden",!g)},updateDebug(g,u,P,R,k){C.textContent=g.toFixed(1),f.textContent=u.toFixed(1),L.textContent=P.toFixed(1),S.textContent=R,T.textContent=k?k.toFixed(0):"–",A.textContent=t.smoothing.toFixed(2)},getSettings(){return t}}}function X(e){return e*Math.PI/180}function De(e){return e*180/Math.PI}function N(e){let t=e%360;return t<0&&(t+=360),t}function Q(e){return((e+180)%360+360)%360-180}function fe(e,t,o,a){const n=6371.0088,i=X(o-e),s=X(a-t),c=Math.sin(i/2)**2+Math.cos(X(e))*Math.cos(X(o))*Math.sin(s/2)**2,r=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));return n*r}function Ee(e,t,o,a){const n=X(e),i=X(o),s=X(a-t),c=Math.sin(s)*Math.cos(i),r=Math.cos(n)*Math.sin(i)-Math.sin(n)*Math.cos(i)*Math.cos(s),m=De(Math.atan2(c,r));return N(m)}function Ie(e,t,o){const a=Q(t-e);return N(e+a*(1-Math.exp(-o)))}function le(e,t,o){return e+(t-e)*(1-Math.exp(-o))}async function Pe(){try{const e=window,t=e.DeviceMotionEvent&&typeof e.DeviceMotionEvent.requestPermission=="function"?await e.DeviceMotionEvent.requestPermission():"granted",o=e.DeviceOrientationEvent&&typeof e.DeviceOrientationEvent.requestPermission=="function"?await e.DeviceOrientationEvent.requestPermission():"granted"}catch{}}async function Oe(e){try{const t=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1});return e.srcObject=t,await e.play(),t}catch(t){return console.warn("Camera access failed",t),null}}function Te(e,t){if(!("geolocation"in navigator))return t(new DOMException("Geolocation not supported")),()=>{};if(!window.isSecureContext)return t(new DOMException("Geolocation requires HTTPS")),()=>{};let o=null;const a={enableHighAccuracy:!0,maximumAge:5e3,timeout:2e4};try{navigator.geolocation.getCurrentPosition(n=>{const{latitude:i,longitude:s,accuracy:c}=n.coords;e({lat:i,lon:s,accuracy:c})},n=>{t(n)},a)}catch(n){t(n)}try{o=navigator.geolocation.watchPosition(n=>{const{latitude:i,longitude:s,accuracy:c}=n.coords;e({lat:i,lon:s,accuracy:c})},n=>t(n),a)}catch(n){t(n)}return()=>{o!==null&&navigator.geolocation.clearWatch(o)}}function Be(e,t,o,a){const n=t*t,i=2*(a*e+t*o),s=1-2*(e*e+n),c=Math.atan2(i,s);let r=2*(a*t-o*e);r=Math.max(-1,Math.min(1,r));const m=Math.asin(r),p=2*(a*o+e*t),v=1-2*(n+o*o);return{yaw:Math.atan2(p,v)*180/Math.PI,pitch:m*180/Math.PI,roll:c*180/Math.PI}}function Le(e){let t=e.smoothing,o=e.headingOffsetDeg,a=new Set,n="deviceorientation+motion",i=null,s=0,c=0,r=0,m=0,p={headingDeg:0,pitchDeg:0,rollDeg:0,timestamp:performance.now()};const v=.02,B=.01;let D=null;const F=window,b=F.AbsoluteOrientationSensor,_=F.RelativeOrientationSensor;let E=null;function C(h){const l=N(s+o),d=c,w=r,I=Ie(p.headingDeg,l,t),y=le(p.pitchDeg,d,t),M=le(p.rollDeg,w,t),g={headingDeg:I,pitchDeg:y,rollDeg:M,source:n,timestamp:h};p=g,a.forEach(u=>u(g))}function f(){try{const h=b||_;if(!h)return!1;const l=new h({frequency:60});return E=l,n="generic-sensor",l.onreading=()=>{const d=l.quaternion;if(!d)return;const{yaw:w,pitch:I,roll:y}=Be(d[0],d[1],d[2],d[3]);s=N(w),c=I,r=y,C(performance.now())},l.onerror=()=>{},l.start(),!0}catch{return!1}}function L(){n="deviceorientation+motion";function h(d){const w=d;typeof w.webkitCompassHeading=="number"?D=N(w.webkitCompassHeading):typeof d.alpha=="number"&&(D=N(d.alpha))}function l(d){const w=performance.now(),I=m?(w-m)/1e3:0;m=w;const y=d.rotationRate;if(y){const g=y.alpha??0,u=y.beta??0,P=y.gamma??0;s=N(s+g*I),c=c+u*I,r=r+P*I}const M=d.accelerationIncludingGravity;if(M){const g=M.x??0,u=M.y??0,P=M.z??-9.8,R=Math.atan2(-g,Math.hypot(u,P))*180/Math.PI,k=Math.atan2(u,P)*180/Math.PI;c=c*(1-v)+R*v,r=r*(1-v)+k*v}if(D!=null){const g=Q(D-s);s=N(s+g*B)}C(w)}return window.addEventListener("deviceorientation",h,!0),window.addEventListener("devicemotion",l,!0),()=>{window.removeEventListener("deviceorientation",h,!0),window.removeEventListener("devicemotion",l,!0)}}let S=[];function T(){n="virtual";let h=!1,l=0,d=0;const w=.1,I=.1;function y(u){h=!0,l=u.clientX,d=u.clientY,u.target.setPointerCapture?.(u.pointerId)}function M(u){h=!1,u.target.releasePointerCapture?.(u.pointerId)}function g(u){if(!h)return;const P=u.clientX-l,R=u.clientY-d;l=u.clientX,d=u.clientY,s=N(s+P*w),c=Math.max(-89,Math.min(89,c-R*I)),C(performance.now())}window.addEventListener("pointerdown",y),window.addEventListener("pointerup",M),window.addEventListener("pointermove",g),S.push(()=>{window.removeEventListener("pointerdown",y),window.removeEventListener("pointerup",M),window.removeEventListener("pointermove",g)})}if(!f()){const h=L();S.push(h);const l=setTimeout(()=>{m===0&&D==null&&T()},2e3);S.push(()=>clearTimeout(l))}function $(){C(performance.now()),i=requestAnimationFrame($)}return i=requestAnimationFrame($),{subscribe(h){return a.add(h),()=>a.delete(h)},setSmoothing(h){t=Math.max(0,Math.min(.3,h))},setHeadingOffset(h){o=h},getSource(){return n},stop(){i!==null&&cancelAnimationFrame(i),S.forEach(h=>h()),E?.stop?.(),a.clear()}}}function ke(e,t,o){const a=o/2,n=e/t*a+a;return Math.max(0,Math.min(o,n))}function Re(e,t,o){const a=o/2,n=-e/t*a+a;return Math.max(0,Math.min(o,n))}function Ce(e,t,o){return e*(o/Math.max(1,t))}function Ae(e,t){const o=t/2;return e>=-o&&e<=o}function Ge(e){return e<0?"left":"right"}const Fe=[[[-168,72],[-140,72],[-120,70],[-95,78],[-65,83],[-52,72],[-60,60],[-75,50],[-95,45],[-110,35],[-120,30],[-125,25],[-130,30],[-140,50],[-168,72]],[[-81,12],[-75,-4],[-70,-15],[-63,-22],[-54,-33],[-52,-47],[-38,-46],[-35,-8],[-59,5],[-81,12]],[[-10,35],[0,43],[10,45],[20,48],[24,60],[30,60],[40,45],[30,41],[19,40],[10,36],[-10,35]],[[5,58],[12,62],[20,66],[25,70],[30,70],[32,65],[24,60],[16,58],[5,58]],[[-17,37],[0,35],[10,34],[25,31],[32,24],[35,15],[44,-10],[40,-20],[32,-35],[15,-35],[5,-25],[-5,-5],[-10,10],[-17,15],[-17,37]],[[35,33],[44,36],[55,35],[60,40],[70,45],[75,35],[70,25],[60,24],[50,20],[40,25],[35,33]],[[70,45],[85,50],[105,50],[120,45],[135,48],[150,45],[132,25],[120,20],[110,15],[105,10],[100,8],[95,12],[90,15],[85,20],[78,8],[70,25],[70,45]],[[126,37],[131,39],[141,43],[143,41],[141,36],[135,34],[129,33],[126,37]],[[113,-10],[153,-10],[153,-43],[114,-35],[113,-10]],[[-52,72],[-40,78],[-30,82],[-20,80],[-35,70],[-45,65],[-52,72]],[[-180,-60],[-120,-60],[-60,-60],[0,-60],[60,-60],[120,-60],[180,-60],[-180,-60]]];function q(e,t,o,a,n,i){const s=o+(e+180)/360*n,c=a+(90-t)/180*i;return{px:s,py:c}}function H(e){return e*Math.PI/180}function de(e){return e*180/Math.PI}function te(e,t,o,a){const i=a/6371,s=H(o),c=H(e),r=H(t),m=Math.sin(c),p=Math.cos(c),v=Math.sin(i),B=Math.cos(i),D=m*B+p*v*Math.cos(s),F=Math.asin(Math.max(-1,Math.min(1,D))),b=Math.sin(s)*v*p,_=B-m*D,E=r+Math.atan2(b,_);return{lat:de(F),lon:(de(E)+540)%360-180}}function _e(e,t,o,a,n,i){e.beginPath(),e.moveTo(t+i,o),e.arcTo(t+a,o,t+a,o+n,i),e.arcTo(t+a,o+n,t,o+n,i),e.arcTo(t,o+n,t,o,i),e.arcTo(t,o,t+a,o,i),e.closePath()}function $e(e,t){const{x:o,y:a,w:n,h:i,user:s,headingDeg:c,hfovDeg:r,maxDistanceKm:m,cities:p}=t;e.save(),e.globalAlpha=.95,e.fillStyle="rgba(10,12,14,0.7)",_e(e,o,a,n,i,8),e.fill(),e.restore(),e.save(),e.strokeStyle="rgba(120,160,120,0.6)",e.fillStyle="rgba(40,80,50,0.35)",e.lineWidth=1;for(const f of Fe){const L=q(f[0][0],f[0][1],o,a,n,i);e.beginPath(),e.moveTo(L.px,L.py);for(let S=1;S<f.length;S++){const{px:T,py:A}=q(f[S][0],f[S][1],o,a,n,i);e.lineTo(T,A)}e.closePath(),e.fill(),e.stroke()}e.restore();const v=q(s.lon,s.lat,o,a,n,i);e.save(),e.fillStyle="rgba(255,255,255,0.9)",e.beginPath(),e.arc(v.px,v.py,2.5,0,Math.PI*2),e.fill(),e.restore(),e.save(),e.strokeStyle="rgba(255,255,255,0.4)",e.lineWidth=1,e.beginPath();const B=128;for(let f=0;f<=B;f++){const L=f/B*360,S=te(s.lat,s.lon,L,m),T=q(S.lon,S.lat,o,a,n,i);f===0?e.moveTo(T.px,T.py):e.lineTo(T.px,T.py)}e.closePath(),e.stroke(),e.restore(),e.save(),e.strokeStyle="rgba(255,220,120,0.7)",e.fillStyle="rgba(255,220,120,0.15)",e.lineWidth=1;const D=Q(c-r/2),F=Q(c+r/2),b=te(s.lat,s.lon,D,m),_=te(s.lat,s.lon,F,m),E=q(b.lon,b.lat,o,a,n,i),C=q(_.lon,_.lat,o,a,n,i);e.beginPath(),e.moveTo(v.px,v.py),e.lineTo(E.px,E.py),e.lineTo(C.px,C.py),e.closePath(),e.fill(),e.stroke(),e.restore(),e.save();for(const f of p){const S=fe(s.lat,s.lon,f.lat,f.lon)<=m,{px:T,py:A}=q(f.lon,f.lat,o,a,n,i);let $=.25,h="rgba(180,220,255,";if(S){f.lat-s.lat;const l=f.lon-s.lon,d=Math.atan2(Math.sin(H(l))*Math.cos(H(f.lat)),Math.cos(H(s.lat))*Math.sin(H(f.lat))-Math.sin(H(s.lat))*Math.cos(H(f.lat))*Math.cos(H(l)))*180/Math.PI;Math.abs(Q(d-c))<=r/2?($=.9,h="rgba(255,255,255,"):($=.6,h="rgba(120,180,255,")}e.fillStyle=`${h}${$})`,e.fillRect(T-1,A-1,2,2)}e.restore()}const He=e=>`${e.name}|${e.country}`,z=new Map;function Ke(e,t){const n=new Set([...z.keys(),...e.keys()]);for(const i of n){const s=z.get(i)??0,c=e.has(i),r=c?Math.min(1,s+4*t):Math.max(0,s-3*t);r<=0&&!c?z.delete(i):z.set(i,r)}}function Ne(e,t){return{w:e.measureText(t).width+12,h:24}}function We(e,t){return!(e.x+e.w<t.x||t.x+t.w<e.x||e.y+e.h<t.y||t.y+t.h<e.y)}function ue(e,t,o,a=12){const n=new Set,i=Math.max(12,e.h+6),s=e.y,c=[s];for(let r=1;r<=a;r++)c.push(s-r*i);for(let r=1;r<=a;r++)c.push(s+r*i);for(let r of c){if(r=Math.max(0,Math.min(o-e.h,r)),n.has(r))continue;n.add(r);const m={x:e.x,y:r,w:e.w,h:e.h};if(!t.some(p=>We(p,m)))return r}return null}function Ye(e,t,o,a){const{width:n,height:i,hfovDeg:s,pitchDeg:c,headingDeg:r,cities:m,user:p,units:v,maxDistanceKm:B,showOffscreenIndicators:D,showMinimap:F}=t,b=Math.max(1,window.devicePixelRatio||1);(e.canvas.width!==Math.floor(n*b)||e.canvas.height!==Math.floor(i*b))&&(e.canvas.width=Math.floor(n*b),e.canvas.height=Math.floor(i*b)),e.setTransform(b,0,0,b,0,0),e.clearRect(0,0,n,i);const _=Ce(s,n,i),E=Re(c,_,i);e.save(),e.strokeStyle="rgba(180,200,220,0.25)",e.lineWidth=2,e.beginPath(),e.moveTo(0,E),e.lineTo(n,E),e.stroke(),e.restore();const C=.621371,f=m.map(l=>{const d=fe(p.lat,p.lon,l.lat,l.lon);return{c:l,distKm:d,bearing:Ee(p.lat,p.lon,l.lat,l.lon)}}).filter(l=>l.distKm<=B);f.sort((l,d)=>d.c.population-l.c.population);const L=[],S=[],T=[],A=new Set,$=24,h=a.v?Math.min(.1,(o-a.v)/1e3):0;a.v=o;for(const l of f){const d=He(l.c),w=Q(l.bearing-r),I=!Ae(w,s),y=v==="km"?l.distKm:l.distKm*C,M=y>=100?Math.round(y).toString():y.toFixed(1),g=l.c.population,u=g>=1e6?`~${(g/1e6).toFixed(1)}M`:`~${Math.round(g/1e3)}k`,P=`${l.c.name}, ${l.c.country} — ${M} ${v} — Pop ${u}`;e.font="600 14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";const{w:R,h:k}=Ne(e,P);let ve=ke(w,s,n);const we=Math.max(0,Math.min(i-$,E-6)),G={x:Math.max(4,Math.min(n-R-4,ve-R/2)),y:we-k,w:R,h:k};if(I){if(!D){A.add(d);continue}A.add(d);const x=z.get(d)??0;if(x<=.01)continue;const U=Ge(w),O=6,K=U==="left"?{x:O,y:Math.max(0,Math.min(i-k,E-k/2)),w:R,h:k}:{x:n-O-R,y:Math.max(0,Math.min(i-k,E-k/2)),w:R,h:k},se=U==="left"?S:T,ye=Math.ceil(i/(K.h+6))+2,re=ue(K,se,i,ye);if(re===null)continue;K.y=re,se.push({...K});const W=K.y+K.h/2,ce=K.y+K.h-6;e.save(),e.globalAlpha=x,e.strokeStyle="rgba(255,255,255,0.6)",e.fillStyle="rgba(255,255,255,0.9)",e.lineWidth=2,e.beginPath(),U==="left"?(e.moveTo(O,W),e.lineTo(O+10,W-6),e.moveTo(O,W),e.lineTo(O+10,W+6),e.stroke(),e.textAlign="left",e.fillText(P,O+16,ce)):(e.moveTo(n-O,W),e.lineTo(n-O-10,W-6),e.moveTo(n-O,W),e.lineTo(n-O-10,W+6),e.stroke(),e.textAlign="right",e.fillText(P,n-O-16,ce)),e.restore()}else{const x=Math.ceil(i/(G.h+6))+2,U=ue(G,L,i,x);if(U===null)continue;G.y=U,L.push({...G}),A.add(d);const O=z.get(d)??0;if(O<=.01)continue;e.save(),e.globalAlpha=O,e.fillStyle="rgba(0,0,0,0.45)",e.strokeStyle="rgba(255,255,255,0.2)",Ve(e,G.x,G.y,G.w,G.h,6),e.fill(),e.fillStyle="white",e.shadowColor="rgba(0,0,0,0.6)",e.shadowBlur=2,e.fillText(P,G.x+6,G.y+G.h-6),e.restore()}}if(Ke(A,h),F!==!1){const d=Math.min(240,Math.floor(n*.5)),w=Math.min(140,Math.floor(i*.35)),I=n-8-d,y=i-8-w;$e(e,{x:I,y,w:d,h:w,user:p,headingDeg:r,hfovDeg:s,maxDistanceKm:B,cities:m})}return{visibleCount:L.length}}function Ve(e,t,o,a,n,i){e.beginPath(),e.moveTo(t+i,o),e.arcTo(t+a,o,t+a,o+n,i),e.arcTo(t+a,o+n,t,o+n,i),e.arcTo(t,o+n,t,o,i),e.arcTo(t,o,t+a,o,i),e.closePath()}const qe=document.getElementById("camera"),Y=document.getElementById("overlay"),j=Y.getContext("2d");let V={maxDistanceKm:1e3,units:"km",hfovDeg:60,headingOffsetDeg:0,smoothing:.15,showOffscreenIndicators:!1},ie={lat:39.996,lon:-74.0621},ae=!1,oe=[],ee=Le({smoothing:V.smoothing,headingOffsetDeg:V.headingOffsetDeg});performance.now();let Z=[],je={v:0};const Xe=Se({settings:V,onSettingsChange:e=>{V=e,ee.setSmoothing(e.smoothing),ee.setHeadingOffset(e.headingOffsetDeg)},onStart:async()=>{Ue(),Pe().catch(()=>{}),Oe(qe).catch(()=>{})},onManualGeo:e=>{ie=e,ae=!0,J.setGeoStatus(`${e.lat.toFixed(5)}, ${e.lon.toFixed(5)} (manual)`)}}),J=Xe;function Ue(){J.setGeoStatus("requesting…"),Te(e=>{ie={lat:e.lat,lon:e.lon},ae=!0,J.setGeoStatus(`${e.lat.toFixed(5)}, ${e.lon.toFixed(5)} ±${Math.round(e.accuracy||0)}m`)},e=>{console.warn("Geolocation error",e);let t="location error";const o=e;if(typeof o?.code=="number")switch(o.code){case 1:t="permission denied — check site settings";break;case 2:t="position unavailable";break;case 3:t="timeout — move outdoors or check settings";break;default:t="location error"}else o?.message&&(t=o.message);J.setGeoStatus(t),J.showManualGeo(!0)})}async function ze(){oe=await(await fetch("./cities.json")).json()}function me(){const e=Y.getBoundingClientRect();Y.width=e.width*window.devicePixelRatio,Y.height=e.height*window.devicePixelRatio}window.addEventListener("resize",me);me();let he=performance.now(),ne=0;ee.subscribe(e=>{ne++;const t=performance.now();if(t-he>1e3){Z.push(ne),Z.length>4&&Z.shift();const o=Z.reduce((a,n)=>a+n,0)/Z.length;J.updateDebug(e.headingDeg,e.pitchDeg,e.rollDeg,e.source,o),ne=0,he=t}});function pe(){const e=performance.now();let t=window.__arc_heading??0,o=window.__arc_pitch??0;window.__arc_bound||(window.__arc_bound=!0,ee.subscribe(i=>{window.__arc_heading=i.headingDeg,window.__arc_pitch=i.pitchDeg,window.__arc_roll=i.rollDeg}));const a=Y.clientWidth,n=Y.clientHeight;Y.width=Math.floor(a*window.devicePixelRatio),Y.height=Math.floor(n*window.devicePixelRatio),j.setTransform(window.devicePixelRatio,0,0,window.devicePixelRatio,0,0),ae&&oe.length>0?Ye(j,{width:a,height:n,hfovDeg:V.hfovDeg,pitchDeg:o,headingDeg:t,units:V.units,maxDistanceKm:V.maxDistanceKm,user:ie,cities:oe,showOffscreenIndicators:V.showOffscreenIndicators},e,je):(j.clearRect(0,0,a,n),j.fillStyle="rgba(255,255,255,0.7)",j.font="600 16px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial",j.textAlign="center",j.fillText("Press Start and allow permissions",a/2,n/2)),requestAnimationFrame(pe)}ze();requestAnimationFrame(pe);"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").catch(()=>{});
